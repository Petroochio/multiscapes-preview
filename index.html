<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>AHOD</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/0.7.1/aframe.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
      }

      body {
        font-family: sans-serif;
        font-size: 12px;
        line-height: 1.5;
        overflow: hidden;
        background: #000000;
      }

      .hidden-vid {
        position: absolute;
        z-index: 1;
      }

      #root {
        width: 100vh;
        height: 100vh;
        z-index: 10;
        position: absolute;
        top: 0;
        left: 0;
      }

    </style>
  </head>

  <body>
    <!-- <video id="wheat-vid" class="hidden-vid" loop muted autoplay width="250">
      <source src="./videos/wheat.mp4" type="video/mp4">
    </video>
    <video id="wave-vid" class="hidden-vid" loop muted autoplay width="250">
      <source src="./videos/waves.mp4" type="video/mp4">
    </video> -->
    <script>
      // let isMouseDown = false;
      let zoom = 1;
      const ZOOM_DIFF = 5;

      // All components go here
      AFRAME.registerComponent('stage-x-rotate', {
        isMouseDown: false,
        init: function() {
          document.addEventListener('mousedown', () => this.isMouseDown = true);
          document.addEventListener('mouseup', () => this.isMouseDown = false);
          document.addEventListener('mouseleave', () => this.isMouseDown = false);
          document.addEventListener('mousemove', (e) => {
            if (this.isMouseDown) {
              this.el.object3D.rotation.y += e.movementX * zoom * 0.004;
            }
          });
        }
      });

      AFRAME.registerComponent('stage-y-rotate', {
        isMouseDown: false,
        init: function() {
          document.addEventListener('mousedown', () => this.isMouseDown = true);
          document.addEventListener('mouseup', () => this.isMouseDown = false);
          document.addEventListener('mouseleave', () => this.isMouseDown = false);
          document.addEventListener('mousemove', (e) => {
            if (this.isMouseDown) {
              this.el.object3D.rotation.x += e.movementY * zoom * 0.004;

              if (this.el.object3D.rotation.x < -0.1) this.el.object3D.rotation.x = -0.1;
              if (this.el.object3D.rotation.x > 1.32) this.el.object3D.rotation.x = 1.32;
            }
          });
        }
      });

      AFRAME.registerComponent('camera-zoom', {
        zoom: 1,
        init: function() {
          
          document.addEventListener('wheel', (e) => {
            this.zoom += e.deltaY / 50;
            if (this.zoom < 0) this.zoom = 0;
            if (this.zoom > 1) this.zoom = 1;
            this.el.object3D.position.z = 4 + (6 * this.zoom);  
          });
        }
      });
    </script>

    <a-scene class="fullscreen" inspector="" keyboard-shortcuts="" screenshot="" vr-mode-ui="">
      <a-assets>
        <video id="waves" autoplay loop="true" src="./videos/waves.mp4"></video>
      </a-assets>

      <a-camera camera-zoom position="0 -0.5 10" look-controls="enabled: false" wasd-controls="enabled: false"></a-camera>
      <!-- <a-entity id="stage">
          <a-entity id="stage-2"> -->
      <a-entity id="stage" stage-y-rotate>
        <a-entity id="stage-2" stage-x-rotate>
          <a-entity light="color:#aaa; intensity:1.5;" position="-1 5.173 -1"></a-entity>
          <!-- <a-entity light="color:#AFA; intensity:1.5;" position="-4.336 5.173 8.016"></a-entity> -->
          <a-cylinder position="0 0 0" shadow radius="0.5" height="1.5" scale="5 0.01 5" material="color:#606060"></a-cylinder>

          <a-box position="-1.211 0.75 0" shadow material="color:#8b8b8b" scale="2.5 1.5 0.1" geometry=""></a-box>
          <a-video src="#waves" position="-1.16 0.766 -0.064" geometry="width:2.6;height:1.5"></a-video>
          <a-box position="0 -0.2 0" shadow material="color:#000000" scale="6 0.4 6"></a-box>
          <a-box position="1.227 0.75 0" material="opacity:0.6;color:#fbfbfb;transparent:true" scale="2.5 1.5 0.01"></a-box>
          <a-box position="-0.53 0.75 1.067" shadow rotation="0 60 0" material="color:#8b8b8b" scale="2.5 1.5 0.1"></a-box>
          <a-entity id="pillars">
            <a-box position="-1.64 0.032 -1.224" shadow material="color:#ececec" scale="0.2 0.5 0.2"></a-box>
            <a-box position="1.021 -0.098 -1.654" shadow material="color:#ececec" scale="0.2 0.5 0.2"></a-box>
            <a-box position="1.777 0.184 -0.986" shadowmaterial="color:#ececec" scale="0.2 0.5 0.2"></a-box>
            <a-box position="1.254 0.032 -0.573" shadow material="color:#ececec" scale="0.2 0.5 0.2"></a-box>
            <a-box position="0.222 0.132 -1.745" shadow material="color:#ececec" scale="0.2 0.5 0.2"></a-box>
            <a-box position="0.769 0.2 -1.053" shadow material="color:#ececec" scale="0.2 0.5 0.2"></a-box>
            <a-box position="-0.055 0.238 -1.166" shadow material="color:#ececec" scale="0.2 0.5 0.2"></a-box>
            <a-box position="-1.942 0.177 -0.615" shadow material="color:#ececec" scale="0.2 0.5 0.2"></a-box>
            <a-box position="-0.936 0.08 -0.789" shadow material="color:#ececec" scale="0.2 0.5 0.2"></a-box>
            <a-box position="-0.976 -0.076 -1.43" shadow material="color:#ececec" scale="0.2 0.5 0.2"></a-box>
          </a-entity>
          <a-sphere id="light-demo" shadow color="#000088" position="-1.159 0.582 0.702" geometry="radius:0.2"></a-sphere>
          <!-- <a-entity light="type: spot; color: #AFA; intensity: 1.5" position="-1 1 0"></a-entity> -->
          <a-entity id="spotlights">
            <a-entity light="type: spot;angle:30;color:#5a5afe;intensity:1.5;type:spot;castShadow:true" position="-0.865 0.25 1.787" rotation="16.78766339733312 19.595156593474155 0.6875493541569879"></a-entity>
          </a-entity>
        </a-entity>
      </a-entity>
      
      <a-sky material="color:#3f3f3f"></a-sky>
    </a-scene>
    <script>
      const stage = document.querySelector('#stage');
      const camera = document.querySelector('#camera');
    </script>
  </body>
</html>